New tests cases for validation:
* make an error for arrays that are empty
* validate references to container resources correctly
* fix for ATC implementation on tx.fhir.org

+ Fix bug in snapshot generation (contentReference being populated wrong)